# 複数ファイル読み取りツール (`read_many_files`)

このドキュメントでは、Gemini CLI の `read_many_files` ツールについて説明します。

## 説明

`read_many_files` を使用して、パスまたは glob パターンで指定された複数のファイルからコンテンツを読み取ります。このツールの動作は、提供されたファイルによって異なります。

- テキストファイルの場合、このツールはそれらの内容を単一の文字列に連結します。
- 画像 (PNG、JPEG など) および PDF ファイルの場合、名前または拡張子で明示的に要求された場合に限り、base64 エンコードされたデータとして読み取って返します。

`read_many_files` は、コードベースの概要の取得、特定の機能が実装されている場所の検索、ドキュメントの確認、複数の設定ファイルからのコンテキストの収集などのタスクを実行するために使用できます。

### 引数

`read_many_files` は次の引数を取ります。

- `paths` (文字列のリスト、必須): glob パターンまたはツールのターゲットディレクトリからの相対パスの配列 (例: `["src/**/*.ts"]`、`["README.md", "docs/", "assets/logo.png"]`)。
- `exclude` (文字列のリスト、オプション): 除外するファイル/ディレクトリの glob パターン (例: `["**/*.log", "temp/"]`)。`useDefaultExcludes` が true の場合、これらはデフォルトの除外に追加されます。
- `include` (文字列のリスト、オプション): 含める追加の glob パターン。これらは `paths` とマージされます (例: 広範囲に除外されていた場合にテストファイルを具体的に追加するための `["*.test.ts"]`、または特定の画像タイプを含めるための `["images/*.jpg"]`)。
- `recursive` (ブール値、オプション): 再帰的に検索するかどうか。これは主に glob パターンの `**` によって制御されます。デフォルトは `true` です。
- `useDefaultExcludes` (ブール値、オプション): デフォルトの除外パターンのリスト (例: `node_modules`、`.git`、画像/PDF 以外のバイナリファイル) を適用するかどうか。デフォルトは `true` です。
- `respect_git_ignore` (ブール値、オプション): ファイルを検索する際に .gitignore パターンを尊重するかどうか。デフォルトは true です。

## Gemini CLI で `read_many_files` を使用する方法

`read_many_files` は、提供された `paths` および `include` パターンに一致するファイルを検索し、`exclude` パターンおよびデフォルトの除外 (有効な場合) を尊重します。

- テキストファイルの場合: 一致した各ファイルの内容を読み取り (画像/PDF として明示的に要求されていないバイナリファイルをスキップしようとします)、各ファイルの内容の間に区切り文字 `--- {filePath} ---` を付けて単一の文字列に連結します。デフォルトでは UTF-8 エンコーディングを使用します。
- 画像および PDF ファイルの場合: 名前または拡張子で明示的に要求された場合 (例: `paths: ["logo.png"]` または `include: ["*.pdf"]`)、ツールはファイルを読み取り、その内容を base64 エンコードされた文字列として返します。
- このツールは、初期コンテンツのヌルバイトを確認することにより、他のバイナリファイル (一般的な画像/PDF タイプに一致しない、または明示的に要求されていないもの) を検出してスキップしようとします。

使用法:

```
read_many_files(paths=["ここにファイルまたはパスを入力してください。"], include=["含める追加ファイル。"], exclude=["除外するファイル。"], recursive=False, useDefaultExcludes=false, respect_git_ignore=true)
```

## `read_many_files` の例

`src` ディレクトリ内のすべての TypeScript ファイルを読み取る:

```
read_many_files(paths=["src/**/*.ts"])
```

メインの README、`docs` ディレクトリ内のすべての Markdown ファイル、および特定のロゴ画像を読み取り、特定のファイルを除外する:

```
read_many_files(paths=["README.md", "docs/**/*.md", "assets/logo.png"], exclude=["docs/OLD_README.md"])
```

すべての JavaScript ファイルを読み取るが、テストファイルと `images` フォルダ内のすべての JPEG を明示的に含める:

```
read_many_files(paths=["**/*.js"], include=["**/*.test.js", "images/**/*.jpg"], useDefaultExcludes=False)
```

## 重要な注意点

- **バイナリファイルの処理:**
  - **画像/PDF ファイル:** このツールは一般的な画像タイプ (PNG、JPEG など) と PDF ファイルを読み取り、base64 エンコードされたデータとして返すことができます。これらのファイルは、`paths` または `include` パターンによって明示的にターゲットにする必要があります (例: `image.png` のような正確なファイル名を指定するか、`*.jpeg` のようなパターンを指定します)。
  - **その他のバイナリファイル:** このツールは、初期コンテンツのヌルバイトを調べることにより、他の種類のバイナリファイルを検出してスキップしようとします。このツールは、これらのファイルを出力から除外します。
- **パフォーマンス:** 非常に多数のファイルまたは非常に大きな個々のファイルを読み取ると、リソースを大量に消費する可能性があります。
- **パスの具体性:** パスと glob パターンがツールのターゲットディレクトリに対して正しく指定されていることを確認してください。画像/PDF ファイルの場合、パターンがそれらを含めるのに十分具体的であることを確認してください。
- **デフォルトの除外:** デフォルトの除外パターン (`node_modules`、`.git` など) に注意し、それらを上書きする必要がある場合は `useDefaultExcludes=False` を使用しますが、慎重に行ってください。
